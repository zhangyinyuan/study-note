# 软路由安装


## 修改静态IP
> 特别注意，要添加网关，否则无法上网，ping外网不通
> 特别注意，要添加dns，否则无法解析域名
> 网关指向主路由IP 192.168.1.1(每个路由器可能不同，可以手机连接WIFI，网络详细中查看)

`vi /etc/config/network`,找到 config interface 'lan' 部分，按以下格式调整成自己的信息

```shell
config interface 'lan'
        option type 'bridge'
        option ifname 'eth0'
        option proto 'static'
        option ipaddr '192.168.1.100'
        option netmask '255.255.255.0'
        option gateway '192.168.1.1'
        option ip6assign '60'
        option dns '192.168.1.1'
        option dns '8.8.8.8'
```

修改好之后， 重启网络 `service network restart`



然后查看路由，没看到网关**192.128.1.1**，表示网关没有添加

```shell
root@OpenWrt:~# route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
192.168.1.0     0.0.0.0         255.255.255.0   U     0      0        0 br-lan
root@OpenWrt:~# ip route
192.168.1.0/24 dev br-lan proto kernel scope link src 192.168.1.100
```

临时添加网关测试，如果能上网，通过修改`/etc/config/network`配置持久化即可

```shell
root@OpenWrt:~# ip route add default via 192.168.1.1
root@OpenWrt:~# route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         192.168.1.1     0.0.0.0         UG    0      0        0 br-lan
192.168.1.0     0.0.0.0         255.255.255.0   U     0      0        0 br-lan
root@OpenWrt:~# ip route
default via 192.168.1.1 dev br-lan proto static
192.168.1.0/24 dev br-lan proto kernel scope link src 192.168.1.100
root@OpenWrt:~# ping baidu.com
PING baidu.com (39.156.66.10): 56 data bytes
64 bytes from 39.156.66.10: seq=0 ttl=53 time=29.502 ms
64 bytes from 39.156.66.10: seq=1 ttl=53 time=29.328 ms
64 bytes from 39.156.66.10: seq=2 ttl=53 time=29.238 ms
```

