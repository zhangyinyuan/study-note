# 上午题 #9 设计模式

## 总览

- 工厂单例建原型:  **创建型模式**
- 世代外接享组合: **结构性模式**
- 剩下的(其他的)都是行为型模式共11个

### **创建型模式**(5个):

1. 工厂方法  (**创建型类**)
2. 抽象工厂方法 (创建型对象)
3. 单例模式 (创建型对象)
4. 建造者模式 (创建型对象)
5. 原型模式 (创建型对象)

### 结构性模式(7种):

1. 装饰器模式  (结构型对象)
2. 适配器模式  **特殊:** **既是**结构型对象模式 ,**也是**结构型类模式
3. 代理模式 (结构型对象)
4. 外观者模式 (结构型对象)
5. 桥接模式 (结构型对象)
6. 享元模式 (结构型对象)
7. 组合模式 (结构型对象)

### 行为型模式(11种)

1. 策略模式  (行为型对象)
2. 模板方法模式  (**行为型类模式**)
3. 观察者模式 (行为型对象)
4. 迭代子模式 (行为型对象)
5. 责任链模式 (行为型对象)
6. 命令模式 (行为型对象)
7. 备忘录模式 (行为型对象)
8. 状态模式 (行为型对象)
9. 访问者模式 (行为型对象)
10. 中介者模式 (行为型对象)
11. 解释器模式 (**行为型类模式**)

---

## 单例模式 Singleton

### 意图

保证一个类仅有一个实例，并提供一个访问它的全局访问点

### 用途

![image-20250330144433264](../../../images/image-20250330144433264.png)

---

![image-20250330164807286](../../../images/image-20250330164807286.png)

---



---

## 工厂方法模式 Factory

### 特点

1. **仅创建单一产品**，不涉及产品族
2. 



## 抽象工厂模式 Abstract Factory

### 特点

1. **创建多个产品族**
2. **多个抽象产品**接口
3. 1个工厂级产生多个产品

### 意图:

提供一个**创建一系列**相关或相互依赖对象的**接口**,而**无需指定**他们**具体的类**

![image-20250330151536190](../../../images/image-20250330151536190.png)

---

![image-20250330161028516](../../../images/image-20250330161028516.png)

---

## 生成器模式(Builder)/建造者模式

### 意图

将一个**复杂类**的**表示与其构造相分离**，使得**相同的构建过程**能够**得出不同的表示**

### 特点

Builder模式适用于：

1. 当**创建复杂对象**的算法应该**独立**于该对象的**组成部分**以及它们的**装配方式**时
2. 当**构造过程**必须**允许**被构造的**对象有不同的表示时**

![image-20250330162023336](../../../images/image-20250330162023336.png)

---

![image-20250330162218535](../../../images/image-20250330162218535.png)

---

![image-20250330162350310](../../../images/image-20250330162350310.png)

---

## 适配器模式 Adapter

### 意图:

将1个类的接口**转换**为客户希望的另1个类的接口

**转换原接口** 得到 **兼容的接口**

![image-20250330165155110](../../../images/image-20250330165155110.png)

---

## 桥接模式 Bridge

### 意图:

将**抽象部分**与**实现**部分**分离**, 使他们可以**独立变化**

英文单词关键词:**OperationImp**

Bridge模式适用于：

1. **不希望**在**抽象**和它的**实现部分**之间**有**一个**固定**的**绑定关系**。
2. 类的抽象以及它的实现都应该可以通过**生成子类**的方法**加以扩充**。
3. 对一个抽象的实现部分的修改应对客户不产生影响，即**客户代码不必重新编译**。
4. 有许多类要生成的**类层次结构**。
5. 想在多个对象间**共享实现**（可能使用引用计数），但同时要求客户并不知道这一点。

---

![image-20250330165544631](../../../images/image-20250330165544631.png)

---

![image-20250330165832192](../../../images/image-20250330165832192.png)

---

![image-20250330171618531](../../../images/image-20250330171618531.png)

---

 ## 组合模式 Composite

### 意图

将对象**组合成树型结构**以表示“**部分-整体**”的的**层次结构**。Composite使  得用户对单个对象
和组合对象的使用具有一致性。

### 适用性

1. 想表示对象的**部分-整体层次结构**。
2. 希望用户**忽略组合对象与单个对象的不同**，用户将统一地使用组合结构中的所有对象。

![image-20250330190741968](../../../images/image-20250330190741968.png)

---

![image-20250330193000426](../../../images/image-20250330193000426.png)

分析:

- **Component**：作为抽象基类，定义了所有部件（包括叶子`Leaf`和组合`Composite`）的通用接口（如`add()`、`remove()`）。
- `Composite`是`Component`的子类，实现有子部件的具体行为。
- `Leaf`是叶子节点，不包含子部件（可能抛出“不支持操作”异常）

---

![image-20250330193646453](../../../images/image-20250330193646453.png)

---

![image-20250330194825110](../../../images/image-20250330194825110.png)

---

## 装配器模式 Decorator

### 意图

动态地**给对象添加一些职责**, **比生成子类更加灵活**

![image-20250330195151765](../../../images/image-20250330195151765.png)

---

其中：
Component定义一个对象接口，可以给这些对象动态地添加职责。
ConcreteComponent定义一个对象，可以给这个对象添加一些职责。
Decorator 维持一个指向Component 对象的指针，并定义一个与 Component 接口一致
的接口。
ConcreteDecorator向组件添加职责。
### 适用性

1. 在不影响其他对象的情况下，以动态、透明的方式给单个对象添加职责
2.  处理那些可以撤销的职责。
3. 当不能采用生成子类的方式进行扩充时。一种情况是，可能有大量独立的扩展，为支
   持每一种组合将产生大量的子类，使得子类数目呈爆炸性增长。另一种情况可能是，
4. 由于类定义被隐藏，或类定义不能用于生成子类。

---

## 外观模式 Facade

### 意图

定义一个高层接口，为子系统中的一组接口提供一个一致的外观，从而简化了该子系统的使用



将一系列对象**加以包装**以**简化接口**

### 结构

![image-20250330202116848](../../../images/image-20250330202116848.png)

- Facade知道哪些**子系统**类负责处理请求；将客户的请求**代理**给适当的子系统对象。**不要混淆认为代理模式**
- **Subsystem** classes实现**子系统**的功能；处理有Facade对象指派的任务；没有Facade的
  任何相关信息，即没有指向Facade的指针。

---

![image-20250330202919930](../../../images/image-20250330202919930.png)

---

![image-20250330230701571](../../../images/image-20250330230701571.png)

---

## 享元模式 Flyweight

### 意图

运用**共享技术**有效地**支持大量细粒度的对象**

### 结构

![image-20250330230844828](../../../images/image-20250330230844828.png)

---

![image-20250330231101882](../../../images/image-20250330231101882.png)

---

## 代理模式 Proxy

### 意图

通过**提供相同的接口**,**为其他对象**提供代理以**控制**这个**对象**的**访问**

### 结构

![image-20250330231309902](../../../images/image-20250330231309902.png)

---

![image-20250330231528381](../../../images/image-20250330231528381.png)

---

## 责任链模式 Chain Of Reponsibility

### 意图

**使多个对象都有机会处理请求**,从而**避免发送者和请求者之间的耦合**关系.将这些**对象连接成一条链**,并沿着这条链传递该请求,直到有一个对象处理它为止

### 结构

![image-20250330232201518](../../../images/image-20250330232201518.png)

1. Handler定义一个处理请求的接口；（可选）实现后继链。
2. ConcreteHandler处理它所负责的请求；可访问它的后继者；如果可处理该请求，就处
   理它，否则将该请求转发给后继者。
3. Client向链上的具体处理者（ConcreteHandler）对象提交请求。

![image-20250501164728644](../../../images/image-20250501164728644.png)

---

## 命令模式 Command

### 意图

将一个**请求封装为**一个**对象**，从而可**用不同的请求对客户进行参数化**，将**请求排队**或**记录请求日志**，**支持可撤销**的操作

类图关键英文单词 **Command**、**Execute**

### 适用于:

（1）抽象出待执行的动作以参数化某对象。

（2）在不同的时刻指定、排列和执行请求。

（3）支持取消操作。

（4）支持修改日志。

（5）用构建在原语操作上的高层操作构造一个系统。

### 结构

![image-20250330232751073](../../../images/image-20250330232751073.png)

1. Command 声明执行操作的接口。
2. ConcreteCommand 将一个接收者对象绑定于一个动作；调用接收者相应的操作，以实
   现Execute。
3. Client 创建一个具体命令对象并设定它的接收者。
4. Invoker 要求该命令执行这个请求。
5. Receiver 知道如何实施与执行一个请求相关的操作。任何类都可能作为一个接收者。

---

![image-20250330233006627](../../../images/image-20250330233006627.png)

---

![image-20250330233931024](../../../images/image-20250330233931024.png)

---

## 解释器模式 Expression

### 意图

给定一个语言，定义它的文法的一种表示，并定义一个解释器，这个解释器使用该表示来
解释语言中的句子。

### 结构

![image-20250330234228669](../../../images/image-20250330234228669.png)

----

## 迭代器模式 Iterator

### 意图

提供一种方法顺序访问一个聚合对象中的各个元素,且不能暴漏该对象的内部表示.

### 结构

![image-20250330234508716](../../../images/image-20250330234508716.png)

---

1. Iterator（迭代器）定义访问和遍历元素的接口。
2. ConcreteIterator（具体迭代器）实现迭代器接口；对该聚合遍历时跟踪当前位置。
3. Aggregate（聚合）定义创建相应迭代器对象的接口。
4. ConcreteAggregate（具体聚合）实现创建相应选代器的接口，该操作返回ConcreteIterator
   的一个适当的实例。

---

## 中介者模式 Meditor

### 意图

用一个**对象**来**封装一系列的对象交互**。中介者使各对象不需要显式地相互引用，从而
使其**耦合松散**，而且可以**独立地改变它们之间的交互**。

### 结构

![image-20250330234754741](../../../images/image-20250330234754741.png)

---

### 适用于

## 备忘录模式 Memento

### 意图

在**不破坏封装性的前提下**,**捕获**一个**对象的内部状态**,并在**该对象之外保存这个状态**,从而可以在以后将该对象**恢复**到**原先保存的状态**

### 结构

![image-20250331223328573](../../../images/image-20250331223328573.png)

---

## 观察者模式 Observer

### 意图

定义对象间一对多的关系,**当一个对象的状态发生变化时**,所有**依赖**它的**对象**都能**得到通知并自动更新**



### 结构

![image-20250331230103546](../../../images/image-20250331230103546.png)

---

![image-20250331230325057](../../../images/image-20250331230325057.png)

---

![image-20250331225548646](../../../images/image-20250331225548646.png)

---

## 状态模式 state

### 意图

允许一个对象在其内部状态改变时改变它的行为.对象看起来修改了他的类

### 结构

![image-20250331230629070](../../../images/image-20250331230629070.png)

---

### 适用性

一个对象的行为决定于它的状态,并且时刻根据它的状态改变它的行为

![image-20250331231242521](../../../images/image-20250331231242521.png)

---

![image-20250331231508207](../../../images/image-20250331231508207.png)

---

## 策略模式

### 意图

**定义一系列的算法**,并把他们封装起来,使他们可以相互替换.

### 结构

![image-20250331231654157](../../../images/image-20250331231654157.png)

### 适用性

![image-20250331231837535](../../../images/image-20250331231837535.png)

---

![image-20250331231913915](../../../images/image-20250331231913915.png)

---

## 模板方法模式 Template Method

### 意图

定义1个算法中的算法骨架,而将一些步骤延迟到子类.使得子类可以不修改1个算法的结构即可重新定义该算法的某些特定步骤

### 结构

![image-20250331232214542](../../../images/image-20250331232214542.png)

---

### 适用性

## 访问者模式 Visitor

### 意图

表示1个作用于某个对象中的各元素操作.它允许在不改变各元素的类的前提下定义作用于这些元素的新操作

### 结构

![image-20250331232539160](../../../images/image-20250331232539160.png)

### 适用性

需要对一个对象结构中的对象进行很多不同的并且**不相关的操作**

---

![image-20250331232831742](../../../images/image-20250331232831742.png)

---

![image-20250331234712294](../../../images/image-20250331234712294.png)

---

![image-20250331234853404](../../../images/image-20250331234853404.png)

---

![image-20250331235052900](../../../images/image-20250331235052900.png)

---

![image-20250331235217156](../../../images/image-20250331235217156.png)

---

![image-20250331235650871](../../../images/image-20250331235650871.png)

---

![image-20250331235904114](../../../images/image-20250331235904114.png)

---

![image-20250401000121552](../../../images/image-20250401000121552.png)

---

![image-20250401000310359](../../../images/image-20250401000310359.png)

---

![image-20250401000426721](../../../images/image-20250401000426721.png)

---

