# MySQL-常用语句记录

## 按照子表的id升序查询出子表字段去重并且逗号隔开
```
GROUP_CONCAT(DISTINCT column_name ORDER BY column_name SEPARATOR ',')
```
举例

- b.xxx 的值不区分大小写
select a.*, **GROUP_CONCAT**(**DISTINCT** b.xxx **ORDER BY** b.id ASC **SEPARATOR** ',') as bxxx from order a left join detail b a.id= b.o_id
group by a.id

- b.xxx的值区分大小写
select a.*, **GROUP_CONCAT**(**DISTINCT BINARY**  b.xxx **ORDER BY** b.id ASC **SEPARATOR** ',') as bxxx from order a left join detail b a.id= b.o_id
group by a.id
---

## count(1) count(*) 和 count(name)的区别
### count(1)和count(*)
在 MySQL 中，COUNT(*) 和 COUNT(1) 通常是等价的，因为它们都用来计算表中的行数，并且在大多数情况下，它们的性能和结果是一样的,且性能差异微乎其微
```
SELECT COUNT(*) FROM table;
SELECT COUNT(1) FROM table;
```
### count(name)

- 功能: 计算 name 列中非 NULL 的行数。如果 name 列包含 NULL 值，则这些 NULL 值不会被计入。
- 性能: 由于需要考虑 name 列的 NULL 值，因此在某些情况下，性能可能会略逊色于 COUNT(*)，但差别通常不大。

**总结**: 在大多数情况下，COUNT(*) 和 COUNT(1) 在 MySQL 中表现一致，你可以使用它们中的任何一个来计算行数。不过，**COUNT(*) 通常是更直观和推荐的选择**。

---

### 数据同步差异排查
> 场景: 从A库同步一张表A1到B库的B1, A表总共30001,B表30000条.找出没有同步过去的那一条

方案是查询出A表的所有ID,然后把所有id UNION ALL,在进行两个表的关联
```
SELECT ids.id
FROM (
SELECT  1 as id
UNION ALL SELECT  43581
UNION ALL SELECT  43583
.... 假设中间还有n条
UNION ALL SELECT  43607
UNION ALL SELECT  43609
) AS ids
left join shop_new ds on ds.id = ids.id
where ds.id is null
;
```